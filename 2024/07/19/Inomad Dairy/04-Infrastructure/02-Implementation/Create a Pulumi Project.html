<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0HENBHMXMT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0HENBHMXMT');
</script>
<!-- End Google Analytics -->

  
  <title>Inomad Diary-04-Infrastructure-02-Implementations-02-Create a Pulumi Project | Zhicheng&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,400;0,600;0,800;1,200;1,400;1,600;1,800&display=swap" rel="stylesheet">
  <meta name="description" content="üîé Intro In the last post, I discussed some points of setting up Azure for Inomad‚Äôs infrastructure. In this post, I will be creating a Pulumi project and discuss some interesting points about the init">
<meta property="og:type" content="article">
<meta property="og:title" content="Inomad Diary-04-Infrastructure-02-Implementations-02-Create a Pulumi Project">
<meta property="og:url" content="https://zhicheng-wang.com/2024/07/19/Inomad%20Dairy/04-Infrastructure/02-Implementation/Create%20a%20Pulumi%20Project.html">
<meta property="og:site_name" content="Zhicheng&#39;s Blog">
<meta property="og:description" content="üîé Intro In the last post, I discussed some points of setting up Azure for Inomad‚Äôs infrastructure. In this post, I will be creating a Pulumi project and discuss some interesting points about the init">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-07-19T10:45:38.000Z">
<meta property="article:modified_time" content="2025-06-08T09:08:09.000Z">
<meta property="article:author" content="Zhicheng Wang">
<meta property="article:tag" content="Inomad">
<meta property="article:tag" content="Infrastructure">
<meta property="article:tag" content="Azure">
<meta property="article:tag" content="Pulumi">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Zhicheng's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/icons/favicon.ico">
  
  
<link rel="stylesheet" href="/css/output.css">

  
    <link rel="stylesheet" href="/css/prism.css">
    <script src="/js/prism.js"></script>
  
  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

  <body class="body">
    <div id="container" class="container">
      <div id="wrap">
        <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="header-title-group inner">
      <p id="logo-wrap" class="header-title">
        Zhicheng&#39;s Blog
        <!-- <a href="/" id="logo">Zhicheng&#39;s Blog</a> -->
      </p>
      
        <p id="subtitle-wrap" class="header-subtitle">
          A Chronicles of a Self-taught Programmer: Learn to Debug Life
          <!-- <a href="/" id="subtitle">A Chronicles of a Self-taught Programmer: Learn to Debug Life</a> -->
        </p>
      
      
        <p id="description-wrap" class="header-description">
          Welcome to my blog!
This blog chronicles my personal exploration into the worlds of coding and life itself.
Here, I share the things I encounter while learning to program.
Think of it as me trying to debug life while getting better at debugging code.
Fueled by my own insatiable curiosity (and LLM&#39;s endless patience), bolstered by my humble attitude of learning (with millions of searches on Google),
I&#39;m pretty confident this debugging process will be wrapped up by the end of this century.

‚úâÔ∏è: zcmmwang@gmail.com

          <!-- <a href="/" id="description">Welcome to my blog!
This blog chronicles my personal exploration into the worlds of coding and life itself.
Here, I share the things I encounter while learning to program.
Think of it as me trying to debug life while getting better at debugging code.
Fueled by my own insatiable curiosity (and LLM&#39;s endless patience), bolstered by my humble attitude of learning (with millions of searches on Google),
I&#39;m pretty confident this debugging process will be wrapped up by the end of this century.

‚úâÔ∏è: zcmmwang@gmail.com
</a> -->
        </p>
      
    </div>
    <div id="header-inner" class="nav-menu inner">
      <nav id="main-nav" class="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      
    <div id="site_search" class="site-search">
     <div class="form-group" class="site-search-input">
      <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
     </div>  
    <div id="local-search-result" class="local-search-result"></div>
    </div>
  
    </div>
  </div>
</header>

        <div class="outer">
          <section class="post-container" id="main"><article
  id="post-Inomad Dairy/04-Infrastructure/02-Implementation/Create a Pulumi Project"
  class="h-entry article article-type-post"
  itemprop="blogPost"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div class="article-meta">
    

<p class="article-date">
  Published: <time class="dt-published" datetime="2024-07-19T10:45:38.000Z" itemprop="datePublished">2024-07-19</time>
  <br>
  
  Updated: <time class="dt-published" datetime="2025-06-08T09:08:09.000Z" itemprop="datePublished">2025-06-08</time>
  
</p>
    
  </div>
  <hr />
  <div class="article-inner">
     
    <header class="article-header">
      
  
    <h1 class="p-name article-title" itemprop="headline name">
      Inomad Diary-04-Infrastructure-02-Implementations-02-Create a Pulumi Project
    </h1>
  

    </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
       <h3 id="üîé-Intro"><strong>üîé Intro</strong></h3>
<p>In the last post, I discussed some points of setting up Azure for Inomad‚Äôs infrastructure. In this post, I will be creating a Pulumi project and discuss some interesting points about the initial setup and considerations.</p>
<span id="more"></span>
<h3 id="‚ùì-What-is-Pulumi"><strong>‚ùì What is Pulumi?</strong></h3>
<p>Pulumi is an open-source infrastructure as code tool that allows you to define, deploy, and manage cloud infrastructure using familiar programming languages. It supports multiple cloud providers, including Azure, AWS, Google Cloud, and Kubernetes. Pulumi enables you to write infrastructure code using languages like Python, TypeScript, Go, and C#, providing a more flexible and powerful way to manage cloud resources, which in contrast to traditional IaC tools like Terraform or CloudFormation that use declarative configuration files.</p>
<h3 id="üìö-Initial-Steps"><strong>üìö Initial Steps</strong></h3>
<h3 id="1-Pulumi-Projects-and-Stacks">1. Pulumi Projects and Stacks</h3>
<p>During the initial setup of a Pulumi project, you will encouter some new concepts from Pulumi such as <a target="_blank" rel="noopener" href="https://www.pulumi.com/docs/concepts/projects/">projects</a> and <a target="_blank" rel="noopener" href="https://www.pulumi.com/docs/concepts/stack/">stacks</a>.</p>
<h3 id="2-Pulumi-State-Management">2. Pulumi State Management</h3>
<p>One another one worth mentioning is when you create a stack, the <code>orgName</code> depends on whether you choose to use <a target="_blank" rel="noopener" href="https://www.pulumi.com/docs/concepts/state/#using-a-self-managed-backend">Pulumi Cloud or Self-managed Backends</a> to mange your Pulumi state files. Since I am using self-managed backend, below are some key points to consider.</p>
<p><strong>Where to Store State Files</strong>:<br>
Decide where to store your state files: You can store your state files locally, in a shared file system, or in a cloud storage bucket like Azure Blob Storage or AWS S3.</p>
<p>If you choose Azure Blog Storage like me, here are the links to get started:</p>
<ul>
<li><a href="%5D(https://www.pulumi.com/docs/concepts/state/#using-a-self-managed-backend)">Azure Blob Storage for Pulumi state</a></li>
<li><a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-gb/products/storage/blobs">Azure Blob Storage</a></li>
</ul>
<p>The general steps to set up an Azure Blob Storage for Pulumi state are:</p>
<ul>
<li>Create a resource group if you haven‚Äôt done so to hold the storage account (e.g., <code>rg-dev-storage</code>).</li>
<li>Create a storage account in the resource group. (e.g., <code>dev-storage</code>)<br>
‚ö†Ô∏è Note here, for Azure storage account, you can only name it with Lowercase letters and numbers and must be between 3 and 24 characters long. It is also universally unique so it‚Äôs a good idea to include a unique name like your organization name or project name in it.(e.g., <code>&lt;your-project-name&gt;devstorage</code>)Sometimes the error message is not clear and you might get stuck here. <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/resource-name-rules">Resource Name Rules</a></li>
<li>Create a Blob container in the storage account to hold the state files specifically for your Pulumi project.(e.g., <code>state-container</code>)</li>
<li>Get the storage account key and set environment variable <code>AZURE_STORAGE_KEY</code> to the name of it for Pulumi to use to store the state files in the Azure Blob Storage.</li>
<li>Create and Microsoft Entra user group for developers in the current subscription and assign the <code>Storage Blob Data Contributor</code> role to the group. This is to allow developers to access the storage account and container to read and write the state files.</li>
<li>Login to Pulumi backend using the Azure Blob Storage account and container URL and the storage account key.</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pulumi login azblob://<span class="token operator">&lt;</span>blob-container-name<span class="token operator">></span>?storage_account<span class="token operator">=</span><span class="token operator">&lt;</span>storage-account-name<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="3-Pulumi-Stack-Initialization">3. Pulumi Stack Initialization</h3>
<p>Once you have set up the backends for Pulumi state, you can now initialize a Pulumi project and stack.</p>
<ul>
<li>Create a new stack for the project. Try to use the same name as the environment you are working on (e.g., <code>dev</code>, <code>staging</code>, <code>prod</code>). So the suggested practice here is you creating a stack for each environment you are working on.</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pulumi stack init dev
pulumi config <span class="token builtin class-name">set</span> azure:subscriptionId <span class="token operator">&lt;</span>subscription-id<span class="token operator">></span> <span class="token parameter variable">--stack</span> dev
pulumi stack <span class="token keyword">select</span> dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>When you create a stack you will be asked to specify a secret provider. You can choose to use the default secret provider <code>passphrase</code> or use a custom secret provider. If you choose to use a custom secret provider, you will need to provide the <a target="_blank" rel="noopener" href="https://www.pulumi.com/docs/cli/commands/pulumi_stack_change-secrets-provider/">URL</a> of the secret provider. For example, you can use Azure Key Vault as a secret provider. <a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-gb/services/key-vault/">Azure Key Vault</a></li>
</ul>
 
    </div>
    <footer class="article-footer">
      <button
        title="Share"
        data-url="https://zhicheng-wang.com/2024/07/19/Inomad%20Dairy/04-Infrastructure/02-Implementation/Create%20a%20Pulumi%20Project.html"
        data-id="cmcfbzdrx002f67690i8a3x7k"
        data-title="Inomad Diary-04-Infrastructure-02-Implementations-02-Create a Pulumi Project"
        class="article-share-link"
        type="button"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="1.2em"
          viewBox="0 0 448 512"
        >
          <path
            fill="#ffffff"
            d="M352 224c53 0 96-43 96-96s-43-96-96-96s-96 43-96 96c0 4 .2 8 .7 11.9l-94.1 47C145.4 170.2 121.9 160 96 160c-53 0-96 43-96 96s43 96 96 96c25.9 0 49.4-10.2 66.6-26.9l94.1 47c-.5 3.9-.7 7.8-.7 11.9c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-25.9 0-49.4 10.2-66.6 26.9l-94.1-47c.5-3.9 .7-7.8 .7-11.9s-.2-8-.7-11.9l94.1-47C302.6 213.8 326.1 224 352 224z"
          />
        </svg>
      </button>
        
  <ul class="article-tag-list">
    
      <li class="article-tag-list-item"><a href="/tags/Inomad/">#Inomad</a></li>
    
      <li class="article-tag-list-item"><a href="/tags/Infrastructure/">#Infrastructure</a></li>
    
      <li class="article-tag-list-item"><a href="/tags/Azure/">#Azure</a></li>
    
      <li class="article-tag-list-item"><a href="/tags/Pulumi/">#Pulumi</a></li>
    
  </ul>

    </footer>
  </div>
   
<nav id="article-nav" class="article-nav">
  
    <a href="/2024/07/23/Inomad%20Dairy/04-Infrastructure/02-Implementation/Create%20Resources.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Inomad Diary-04-Infrastructure-02-Implementations-03-Create Resources
        
      </div>
    </a>
  
  
    <a href="/2024/07/18/Inomad%20Dairy/04-Infrastructure/02-Implementation/Azure%20Setup.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Inomad Diary-04-Infrastructure-02-Implementations-01-Azure Setup</div>
    </a>
  
</nav>
 
</article>

 
</section>
           <aside class="sidebar" id="sidebar">
  
    
  <div class="widget-wrap">
    <p class="widget-title">Categories</p>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AI-Projects/">AI Projects</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading/">Reading</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <p class="widget-title">Recent Posts</p>
    <div class="widget">
      <ul>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/24/AI%20LLM/containerization.html">Containerization: A Case Study in Environment and Configuration Management</a>
          </li>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/22/AI%20LLM/illustion-of-quaterly-data.html">The Illusion of Quarterly Data: Correctly Calculating Financials from SEC Filings</a>
          </li>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/19/AI%20LLM/mess-in-financial-filings.html">Mess in SEC Financial Filings: A new Challenge of Data Extraction</a>
          </li>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/18/Reading/think-fast-and-slow.html">Reading Notes: Thinking, Fast and Slow by Daniel Kahneman</a>
          </li>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/14/AI%20LLM/persistent-database.html">Refactoring for Resilience: Introducing a Database Caching Layer</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
          
        </div>
        <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner footer-info">
      
      &copy; 2025 Zhicheng Wang<br>
      <div>
        Powered by 
        <a href="https://hexo.io/" target="_blank">Hexo</a>
      </div>
    </div>
  </div>
</footer>

      </div>
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav> 


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>


<script src="/js/search.js"></script>








<a id="gotop" href="#">   
  <span>‚ñ≤</span> 
</a>

<!-- 
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>
 -->


   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


    </div>
  </body>
</html>
