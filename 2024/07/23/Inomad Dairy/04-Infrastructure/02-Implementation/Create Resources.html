<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0HENBHMXMT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0HENBHMXMT');
</script>
<!-- End Google Analytics -->

  
  <title>Inomad Diary-04-Infrastructure-02-Implementations-03-Create Resources | Zhicheng&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,400;0,600;0,800;1,200;1,400;1,600;1,800&display=swap" rel="stylesheet">
  <meta name="description" content="üîé Intro In this post, I will start creating resources in Azure using Pulumi. The full process is quite complex, so I will try to break it down into smaller parts and raise the key points here during">
<meta property="og:type" content="article">
<meta property="og:title" content="Inomad Diary-04-Infrastructure-02-Implementations-03-Create Resources">
<meta property="og:url" content="https://zhicheng-wang.com/2024/07/23/Inomad%20Dairy/04-Infrastructure/02-Implementation/Create%20Resources.html">
<meta property="og:site_name" content="Zhicheng&#39;s Blog">
<meta property="og:description" content="üîé Intro In this post, I will start creating resources in Azure using Pulumi. The full process is quite complex, so I will try to break it down into smaller parts and raise the key points here during">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-07-23T19:29:57.000Z">
<meta property="article:modified_time" content="2025-06-08T09:08:10.000Z">
<meta property="article:author" content="Zhicheng Wang">
<meta property="article:tag" content="Inomad">
<meta property="article:tag" content="Infrastructure">
<meta property="article:tag" content="Azure">
<meta property="article:tag" content="Pulumi">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Zhicheng's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/icons/favicon.ico">
  
  
<link rel="stylesheet" href="/css/output.css">

  
    <link rel="stylesheet" href="/css/prism.css">
    <script src="/js/prism.js"></script>
  
  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

  <body class="body">
    <div id="container" class="container">
      <div id="wrap">
        <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="header-title-group inner">
      <p id="logo-wrap" class="header-title">
        Zhicheng&#39;s Blog
        <!-- <a href="/" id="logo">Zhicheng&#39;s Blog</a> -->
      </p>
      
        <p id="subtitle-wrap" class="header-subtitle">
          A Chronicles of a üë®‚ÄçüíªProgrammer <b>(with üìäüìàAnalytical Mindset <s>Who was Once a üé®üñåÔ∏èDesigner</s>)</b>: Learn to Debug Life
          <!-- <a href="/" id="subtitle">A Chronicles of a üë®‚ÄçüíªProgrammer &lt;b&gt;(with üìäüìàAnalytical Mindset &lt;s&gt;Who was Once a üé®üñåÔ∏èDesigner&lt;/s&gt;)&lt;/b&gt;: Learn to Debug Life</a> -->
        </p>
      
      
        <p id="description-wrap" class="header-description">
          Welcome to my blog!
This blog chronicles my personal exploration into the worlds of coding <b><s>(with LLMs ofc, what were you expecting?)</s></b> and life itself.
Here, I share the things I encounter while learning to program.
Think of it as me trying to debug life while getting better at debugging code.
Fueled by my own insatiable curiosity <b><s>(and AI's endless patience)</s></b>, bolstered by my humble attitude of learning <b><s>(with millions of searches on Google)</s></b>,
I'm pretty confident this debugging process will be wrapped up by the end of this century.
<br>
<br>
‚úâÔ∏è: zcmmwang@gmail.com
<br>
üåü: <a href="https://github.com/Dogecat0" target="_blank" rel="noopener noreferrer">https://github.com/Dogecat0</a>

          <!-- <a href="/" id="description">Welcome to my blog!
This blog chronicles my personal exploration into the worlds of coding &lt;b&gt;&lt;s&gt;(with LLMs ofc, what were you expecting?)&lt;/s&gt;&lt;/b&gt; and life itself.
Here, I share the things I encounter while learning to program.
Think of it as me trying to debug life while getting better at debugging code.
Fueled by my own insatiable curiosity &lt;b&gt;&lt;s&gt;(and AI&#39;s endless patience)&lt;/s&gt;&lt;/b&gt;, bolstered by my humble attitude of learning &lt;b&gt;&lt;s&gt;(with millions of searches on Google)&lt;/s&gt;&lt;/b&gt;,
I&#39;m pretty confident this debugging process will be wrapped up by the end of this century.
&lt;br&gt;
&lt;br&gt;
‚úâÔ∏è: zcmmwang@gmail.com
&lt;br&gt;
üåü: &lt;a href=&#34;https://github.com/Dogecat0&#34; target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34;&gt;https://github.com/Dogecat0&lt;/a&gt;
</a> -->
        </p>
      
    </div>
    <div id="header-inner" class="nav-menu inner">
      <nav id="main-nav" class="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      
    <div id="site_search" class="site-search">
     <div class="form-group" class="site-search-input">
      <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
     </div>  
    <div id="local-search-result" class="local-search-result"></div>
    </div>
  
    </div>
  </div>
</header>

        <div class="outer">
          <section class="post-container" id="main"><article
  id="post-Inomad Dairy/04-Infrastructure/02-Implementation/Create Resources"
  class="h-entry article article-type-post"
  itemprop="blogPost"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div class="article-meta">
    

<p class="article-date">
  Published: <time class="dt-published" datetime="2024-07-23T19:29:57.000Z" itemprop="datePublished">2024-07-23</time>
  <br>
  
  Updated: <time class="dt-published" datetime="2025-06-08T09:08:10.000Z" itemprop="datePublished">2025-06-08</time>
  
</p>
    
  </div>
  <hr />
  <div class="article-inner">
     
    <header class="article-header">
      
  
    <h1 class="p-name article-title" itemprop="headline name">
      Inomad Diary-04-Infrastructure-02-Implementations-03-Create Resources
    </h1>
  

    </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
       <h3 id="üîé-Intro"><strong>üîé Intro</strong></h3>
<p>In this post, I will start creating resources in Azure using Pulumi. The full process is quite complex, so I will try to break it down into smaller parts and raise the key points here during my implementation.</p>
<span id="more"></span>
<h3 id="üìÅ-Resource-Group"><strong>üìÅ Resource Group</strong></h3>
<p>The resources in Azure are organized into resource groups. A resource group is a logical container for resources deployed on Azure. You can deploy, update, and delete multiple resources in a resource group together. More about <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/manage-resource-groups-portal">Azure Resource Group</a>.</p>
<p>Probably more to be added while it‚Äôs going but at this moment the key resources I am using are:</p>
<ul>
<li>Container App</li>
<li>Container Registry</li>
<li>SQL Server</li>
<li>SQL Database</li>
<li>Key Vault</li>
<li>Storage Account</li>
<li>Blob Container</li>
<li>DevOps</li>
<li>Network</li>
<li>Insights</li>
</ul>
<p>I‚Äôve organized my resources into three resource groups:</p>
<h3 id="1-web-app-rg">1. <code>web_app_rg</code>:</h3>
<ul>
<li>Container App</li>
<li>Container Registry</li>
<li>SQL Server</li>
<li>SQL Database</li>
<li>Key Vault</li>
<li>Storage Account</li>
<li>Blob Container</li>
</ul>
<p><strong>The pros of organizing resources into a resource group are:</strong></p>
<ul>
<li>This group has all application-realted resources, making it easier to manage and monitor the web application.</li>
<li>It‚Äôs easier to mange updates, scaling, and eployments since all app components are in one place.</li>
<li>Simplifies tracking and optimizing costs specifically associated with the web application itself.</li>
<li>It grants the easier managing permissions for developers and operators who need access only to the application resources.</li>
</ul>
<h3 id="2-devops-rg">2. <code>devops_rg</code>:</h3>
<ul>
<li>DevOps</li>
</ul>
<p><strong>The pros of organizing resources into a resource group are:</strong></p>
<ul>
<li>It keeps DevOps resources reparate from the actual application resources, reducing the risk of accidental interference.</li>
<li>It enhanced security by isolating DevOps tools and credentials, ensuring taht only DevOps access.</li>
<li>It simplifies scaling DevOps tools independently of the application resources.</li>
</ul>
<h3 id="3-network-and-monitoring-rg">3. <code>network_and_monitoring_rg</code>:</h3>
<ul>
<li>Network</li>
<li>Insights</li>
</ul>
<p><strong>The pros of organizing resources into a resource group are:</strong></p>
<ul>
<li>Network resources like VNETS, subnets, and security groups are in one place, making it easier to manage network configurations and security.</li>
<li>It centralized location for all monitoring tools, which simplifies the process of setting up and managing alerts, dashboards, and logs.</li>
<li>It enhanced security byisolating network and monitoring resources, ensuring network configurations are not tampered with unintentially.</li>
</ul>
<p>Organizing resources into resource groups is a good practice for managing and monitoring resources in Azure. It depends on the complexity of the application and the team‚Äôs requirements bae on the resources‚Äô nature and purpose. Resources in different resource groups can communicate with each other, which makes it possible if you need more resource groups in the future.</p>
<h3 id="üì¶-Container-Registry"><strong>üì¶ Container Registry</strong></h3>
<p>Azure Container Registry is a managed, private Docker registry service based on the open-source Docker Registry 2.0. It allows you to store and manage container images for all types of container deployments. More about <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/container-registry/">Azure Container Registry</a>.</p>
<p>The Pulumi code to create a container registry in Azure can be find <a target="_blank" rel="noopener" href="https://www.pulumi.com/registry/packages/azure-native/api-docs/containerregistry/registry/">here</a></p>
<h3 id="Things-to-consider-when-creating-a-container-registry">Things to consider when creating a container registry:</h3>
<p><strong>1. Assign role-based access control (RBAC):</strong> RBAC roles to the registry to control access to the registry like <code>AcrPull</code> and <code>AcrPush</code>.</p>
<p>‚ö†Ô∏è Note here, when assigning the roles using <code>pulumi_azure_native.authorization.RoleAssignment</code> to groups or uses in Pulumi Azure, there is one thing quite confusing:<br>
<code>roleDefinitionId</code>: This is the Identifier of the role definition to assign to the principal, which uses the ID of the roles in Azure as part of it.<br>
example of the Identifier: <code>&quot;/subscriptions/$&#123;subscriptionId&#125;/providers/Microsoft.Authorization/roleDefinitions/00000000-0000-0000-0000-000000000000&quot;</code> and <code>providers/Microsoft.Authorization/roleDefinitions/00000000-0000-0000-0000-000000000000&quot;</code>is the ID of the role in Azure you are going to assign.<br>
Currently in Pulumi latest azure-native module, it does not support retrieving the role ID from the role name, so you need to define a function using Azure CLI and use it in the Pulumi code. For example:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_role_id_by_name</span><span class="token punctuation">(</span>role_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>
            <span class="token punctuation">[</span>
                <span class="token string">"az"</span><span class="token punctuation">,</span>
                <span class="token string">"role definition"</span><span class="token punctuation">,</span>
                <span class="token string">"list"</span><span class="token punctuation">,</span>
                <span class="token string">"--query"</span><span class="token punctuation">,</span>
                <span class="token string-interpolation"><span class="token string">f"[?roleName=='</span><span class="token interpolation"><span class="token punctuation">&#123;</span>role_name<span class="token punctuation">&#125;</span></span><span class="token string">'].id"</span></span><span class="token punctuation">,</span>
                <span class="token string">"--output"</span><span class="token punctuation">,</span>
                <span class="token string">"json"</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            capture_output<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
            text<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
            check<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        roles <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>result<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roles<span class="token punctuation">:</span>
            <span class="token keyword">return</span> roles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    <span class="token keyword">except</span> subprocess<span class="token punctuation">.</span>CalledProcessError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error running az command: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    <span class="token keyword">except</span> json<span class="token punctuation">.</span>JSONDecodeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error decoding JSON: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>2. SKU:</strong> Choose the SKU based on the requirements of the application. The SKU determines the capabilities and features of the registry. Here it has <code>Basic</code> and <code>Standard</code> SKUs.</li>
<li><strong>3. Registry Name:</strong> The name of the registry must be unique within Azure. It must be between 5 and 50 characters long alphanumeric.<br>
(‚ö†Ô∏è Note here, since the registry name must be unique within Azure, so it‚Äôs a good idea to include a unique name like your organization name or project name in it. (e.g., <code>&lt;your-project-name&gt;containerregistry</code>). This also applies to other resources in Azure. It‚Äôs also a good practice if you can add corresponding environment names to the resources to make it easier to identify which resources belong to which environment.)</li>
</ul>
<h3 id="üñ•Ô∏è-SQL-Server-and-Database"><strong>üñ•Ô∏è SQL Server and Database</strong></h3>
<p>Azure SQL Database is a fully managed relational database service that provides a broad variety of features to enable you to scale, secure, and monitor your database. More about <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/azure-sql/database/">Azure SQL Database</a>.</p>
<p>The Pulumi code to create a SQL Server and SQL Database in Azure can be find <a target="_blank" rel="noopener" href="https://www.pulumi.com/registry/packages/azure-native/api-docs/sql/">here</a>.</p>
<h3 id="Things-to-consider-when-creating-a-SQL-Server-and-SQL-Database">Things to consider when creating a SQL Server and SQL Database:</h3>
<ul>
<li><strong>1. KeyVault Creation:</strong> Create a <code>KeyVault</code> and assign the Server credentials to the KeyVault to secure them. Of course you need to assign the proper RBAC roles to the KeyVault to allow the SQL Server to access the credentials.</li>
</ul>
<p>‚ö†Ô∏è Note here, pulumi_azure_native does not suppport retireving the actual key value from the KeyVault, so you need to use Azure CLI to retrieve the secret value from the KeyVault and use it in the Pulumi code. For example:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_kv_secret</span><span class="token punctuation">(</span>vault_name<span class="token punctuation">,</span> secret_name<span class="token punctuation">,</span> access_token<span class="token punctuation">,</span> secret_version<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://</span><span class="token interpolation"><span class="token punctuation">&#123;</span>vault_name<span class="token punctuation">&#125;</span></span><span class="token string">.vault.azure.net/secrets/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>secret_name<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
    <span class="token keyword">if</span> secret_version<span class="token punctuation">:</span>
        url <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f"/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>secret_version<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
    url <span class="token operator">+=</span> <span class="token string">"?api-version=7.0"</span>

    headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Bearer </span><span class="token interpolation"><span class="token punctuation">&#123;</span>access_token<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span>

    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>HTTPError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to get secret: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>response<span class="token punctuation">.</span>text<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    secret <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> secret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ü´ô-Storage-Account-and-Blob-Container"><strong>ü´ô Storage Account and Blob Container</strong></h3>
<p>This is the straghtforward part of the implementation. The Pulumi code to create a Storage Account and Blob Container in Azure can be find <a target="_blank" rel="noopener" href="https://www.pulumi.com/registry/packages/azure-native/api-docs/storage/">here</a>.</p>
<h3 id="üöö-Content-Delivery-Network-CDN"><strong>üöö Content Delivery Network (CDN)</strong></h3>
<p>Azure Content Delivery Network (CDN) is a global content delivery network solution for delivering high-bandwidth content. <a target="_blank" rel="noopener" href="https://www.pulumi.com/registry/packages/azure-native/api-docs/cdn/">Pulumi Docs</a>.</p>
<h3 id="Things-to-consider-when-creating-a-Container-App">Things to consider when creating a Container App:</h3>
<p><strong>1. CDN Profile:</strong> The CDN profile is a container for the CDN endpoints. It defines the pricing tier and the CDN provider. The profile should be global.</p>
<p><strong>2. CDN Endpoint:</strong> The CDN endpoint is the actual CDN service that delivers content to end-users. It is associated with a CDN profile and a custom domain name.</p>
<ul>
<li><code>origin</code>: The origin of the CDN endpoint. This is the source of the content that the CDN delivers to end-users. The origin can be a storage account, a web app, or any other public endpoint.<br>
(‚ö†Ô∏è Note, in <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/cli/azure/cdn/endpoint?view=azure-cli-latest#az-cdn-endpoint-create">Micsoft doc</a>, when you create an endpoint, the <code>origin</code> means the <code>custom domain</code> which in Pulumi, is <code>origin_host_header</code>.)</li>
<li><code>origin_group</code>: The origin group is a collection of origins that the CDN endpoint uses to deliver content. The CDN endpoint can use multiple origins to deliver content to end-users. The origin group can be used to define failover and load balancing rules for the CDN endpoint.</li>
</ul>
<h3 id="üõ¢Ô∏è-ContainerApp"><strong>üõ¢Ô∏è ContainerApp</strong></h3>
<p>Azure Container Apps is a fully managed serverless container service that enables you to deploy and run containerized applications without having to manage the underlying infrastructure. More about <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/templates/microsoft.app/containerapps?pivots=deployment-language-bicep#container">Azure Container Apps</a>.</p>
<p>The Pulumi code to create a Container App in Azure can be find <a target="_blank" rel="noopener" href="https://www.pulumi.com/registry/packages/azure-native/api-docs/app/containerapp/">here</a>.</p>
<h3 id="Things-to-consider-when-creating-a-Container-App-2">Things to consider when creating a Container App:</h3>
<p><strong>1. Docker Image:</strong> First, you need to create a image source from the container registry you created earlier and here you also need to install a new module <code>pulumi_docker</code>. Example can be found here in <a target="_blank" rel="noopener" href="https://www.pulumi.com/docs/reference/pkg/docker/image/">Pulumi Docs</a>.</p>
<p>‚ö†Ô∏è Note here, in <code>RegistryArgs</code> you need to fill in the registry credentials to access the container registry. If you‚Äôve created your registry without having credentials, you can use <code>az acr login</code> with your Microsoft Entra ID which you should have assigned acr permissions to or a Service Principle to access the registry.</p>
<p><strong>2. Container App:</strong> Defining the container app requires more configuration. Below is the example of the configuration from the <a target="_blank" rel="noopener" href="https://www.pulumi.com/registry/packages/azure-native/api-docs/app/containerapp/">Pulumi Docs</a>:</p>
<p>‚ö†Ô∏è Concepts I picked up here:</p>
<ul>
<li><code>Microsoft.web</code> and <code>Microsoft.app</code> are the namespaces for the different resources, you can find the full list <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-services-resource-providers">here</a>. Another confusing part is, you can still find <code>Microsoft.web.ContainerApp</code> resource but it is an old version of this resource and it‚Äôs better to use the new version <code>Microsoft.app.ContainerApp</code> as it is stated <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/templates/microsoft.web/containerapps?pivots=deployment-language-bicep">here</a> in Microsoft Docs.</li>
<li><code>dapr</code>: Distributed Application Runtime (Dapr) is a portable, event-driven runtime that makes it easy for developers to build resilient, microservice applications.</li>
<li><code>ingress</code>: Ingress is the process of routing external HTTP(S) traffic to the correct service in your cluster. In ingress there are multiple concepts need attention.</li>
<li><code>client_cerfiticate_mode</code> is the mode of client certificate.<br>
<code>IGNORE</code>: means the client certificate is ignored. This is the default mode where only server-side SSL/TLS is enforced, ensuring that the server is authenticated but not the client. <code>ACCEPT</code>: The application accepts client certificates if presented, but does not require them. If a client certificate is provided, the server will validate it. This mode is useful for applications that can optionally support mTLS for clients that have the necessary certificates but do not require it for all clients. <code>REQUIRE</code>: The application requires all clients to present a valid client certificate to establish a connection. This mode enforces strict mutual authentication, ensuring that only clients with valid certificates can access the application. It is suitable for highly secure environments where all clients are expected to be authenticated.</li>
<li><code>cors_policy</code>: This defines Cross-Origin Resource Sharing policy for Azure Container App. CORS is a security feature that allows or restricts web applications running at one origin (domain) from interacting with resources from different origins.</li>
<li><code>custom_domains</code>: This is the domain that you want to use to access the Azure Container App. <code>binding_type</code>: The type of binding for the custom domain. <code>certificate</code>: The certificate that you want to use for the custom domain gained from associated Container App envrionment. <code>host_name</code>: The host name that you want to use for the custom domain.</li>
<li><code>probes</code> property of <code>containers</code> in `templates: Probes are mechanisms used to check the halth and status of a container. There are three types of probes in Kubernetes and other container orchestrators: liveness probes, readiness probes, and startup probes. Liveness probes are used to determine if a container is running correctly. Readiness probes determine if a container is ready to accept traffic. Startup probes are used to check if an application within a container has started.</li>
</ul>
<p><strong>3. Managed Envrionment:</strong> This is the environment where the container app is going to run. The pulumi code to create a managed environment can be found <a target="_blank" rel="noopener" href="https://www.pulumi.com/registry/packages/azure-native/api-docs/app/managedenvironment/">here</a>. And the Microsoft docs for the managed environment can be found <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/templates/microsoft.app/managedenvironments?pivots=deployment-language-bicep">here</a>.</p>
<p>‚ö†Ô∏è Concepts I picked up here:</p>
<ul>
<li><code>app_logs_configuration</code>: Cluster configuration which enables the log daemon to export app logs to a destination. Currently only ‚Äúlog-analytics‚Äù is supported</li>
<li><code>log_analytics_configuration</code>: Log Analytics configuration, must only be provided when destination is configured as ‚Äòlog-analytics‚Äô. This leads to the creation of another resource <code>LogAnalyticsWorkspace</code> which is a workspace for storing log data. <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/container-apps/log-monitoring?tabs=bash">Microsoft doc</a>. <a target="_blank" rel="noopener" href="https://www.pulumi.com/registry/packages/azure-native/api-docs/operationalinsights/workspace/">Pulumi doc</a>.</li>
<li><code>custom_domain_configuration</code>: Custom domain configuration allows you to map a custom domain (e.g., <a target="_blank" rel="noopener" href="http://www.my-name.com">www.my-name.com</a>) to your Azure managed environment or specific resources within it. This is often necessary when you want your application to be accessible via a branded domain name rather than the default Azure-generated domain name.</li>
</ul>
<h3 id="üõú-Network"><strong>üõú Network</strong></h3>
<p>Network resources in Azure are used to connect and isolate resources in Azure. They provide security and control over the traffic flow between resources. The network itself is a huge topic, here I will just list the basic network settings and points to configure Azure infrastructure with Pulumi. More about <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/virtual-network/">Azure Network</a>.</p>
<p>Things to consider when creating a Network:</p>
<p><strong>1. Virtual Network (VNET):</strong> A virtual network is a network that is logically isolated from other networks in Azure. It allows you to control the flow of traffic between resources in the network and between the network and the internet. More about <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview">Azure Virtual Network</a>.</p>
<p>‚ö†Ô∏è Concepts I picked up here:</p>
<ul>
<li><code>address_space</code>: The address space of the virtual network. This is the range of IP addresses that the virtual network can use. Normally, you can use the default address space <code>10.0.0./16</code>.</li>
<li><code>subnets</code>: The subnets of the virtual network. Subnets are used to divide the virtual network into smaller networks. Each subnet has its own range of IP addresses. Normally, you can use the default subnet <code>10.0.1.0/24</code> for <code>web-subnet</code> and <code>10.0.1.0/24</code> for <code>db-subnet</code>. <a target="_blank" rel="noopener" href="https://techcommunity.microsoft.com/t5/itops-talk-blog/configuring-azure-virtual-network-subnets-with-cidr-notation/ba-p/2047809">Here</a> is a good article about CIDR notation.</li>
<li><code>security_group</code>: Network Security Groups are a fundamental feature in Azure used to manage and control network traffic to and from Azure resources in a virtual network. NSGs act as a firewall at the subnet or network interface level, allowing or deniying traffic based on security rules. <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-network/security-overview">More</a> about Azure Network Security. <code>priority</code> in <code>security_rule</code> is the priority of the rule. The lower the number, the higher the priority. It does not imply the importance of one rule over another but rather dictates which rule is evaluated first when a network packet is processed.</li>
</ul>
 
    </div>
    <footer class="article-footer">
      <button
        title="Share"
        data-url="https://zhicheng-wang.com/2024/07/23/Inomad%20Dairy/04-Infrastructure/02-Implementation/Create%20Resources.html"
        data-id="cmcmlcgr7001xxp69apfeb1sg"
        data-title="Inomad Diary-04-Infrastructure-02-Implementations-03-Create Resources"
        class="article-share-link"
        type="button"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="1.2em"
          viewBox="0 0 448 512"
        >
          <path
            fill="#ffffff"
            d="M352 224c53 0 96-43 96-96s-43-96-96-96s-96 43-96 96c0 4 .2 8 .7 11.9l-94.1 47C145.4 170.2 121.9 160 96 160c-53 0-96 43-96 96s43 96 96 96c25.9 0 49.4-10.2 66.6-26.9l94.1 47c-.5 3.9-.7 7.8-.7 11.9c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-25.9 0-49.4 10.2-66.6 26.9l-94.1-47c.5-3.9 .7-7.8 .7-11.9s-.2-8-.7-11.9l94.1-47C302.6 213.8 326.1 224 352 224z"
          />
        </svg>
      </button>
        
  <ul class="article-tag-list">
    
      <li class="article-tag-list-item"><a href="/tags/Inomad/">#Inomad</a></li>
    
      <li class="article-tag-list-item"><a href="/tags/Infrastructure/">#Infrastructure</a></li>
    
      <li class="article-tag-list-item"><a href="/tags/Azure/">#Azure</a></li>
    
      <li class="article-tag-list-item"><a href="/tags/Pulumi/">#Pulumi</a></li>
    
  </ul>

    </footer>
  </div>
   
<nav id="article-nav" class="article-nav">
  
    <a href="/2025/06/07/AI%20LLM/project-inception-ai-financial-analyst.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          LLM Learning Journey: Building an LLM-powered Financial Analyst with an AI Coding Partner
        
      </div>
    </a>
  
  
    <a href="/2024/07/19/Inomad%20Dairy/04-Infrastructure/02-Implementation/Create%20a%20Pulumi%20Project.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Inomad Diary-04-Infrastructure-02-Implementations-02-Create a Pulumi Project</div>
    </a>
  
</nav>
 
</article>

 
</section>
           <aside class="sidebar" id="sidebar">
  
    
  <div class="widget-wrap">
    <p class="widget-title">Categories</p>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Journal-App/">Journal App</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading/">Reading</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SEC-Analysis/">SEC Analysis</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <p class="widget-title">Recent Posts</p>
    <div class="widget">
      <ul>
        
          <li class="recent-post-list-item">
            <a href="/2025/07/02/Journal%20App/weekly-report-generator.html">Building AI-Powered Weekly Reports with Next.js and LLMs</a>
          </li>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/30/Journal%20App/rerank-agent.html">Optimizing Semantic Search: A Two-Stage Reranker</a>
          </li>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/29/Journal%20App/agentic-rag-pipeline.html">Building an Agentic RAG Pipeline for Journal Analysis</a>
          </li>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/27/Journal%20App/journal-app.html">From .txt to Web App: Building a Journaling System with Gemini&#39;s Help</a>
          </li>
        
          <li class="recent-post-list-item">
            <a href="/2025/06/24/AI%20LLM/containerization.html">Containerization: A Case Study in Environment and Configuration Management</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
          
        </div>
        <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner footer-info">
      
      &copy; 2025 Zhicheng Wang<br>
      <div>
        Powered by 
        <a href="https://hexo.io/" target="_blank">Hexo</a>
      </div>
    </div>
  </div>
</footer>

      </div>
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav> 


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>


<script src="/js/search.js"></script>








<a id="gotop" href="#">   
  <span>‚ñ≤</span> 
</a>

<!-- 
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>
 -->


   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


    </div>
  </body>
</html>
